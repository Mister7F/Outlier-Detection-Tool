[reader]
type = ES
url = http://127.0.0.1:9200
scroll_size = 10000
timeout = 90s


[plotting]
enable = 1
output = plots


[model_b64_encoded_malware]
sql_query = SELECT OsqueryFilter.name AS process_name, OsqueryFilter.cmdline AS b64_len, OsqueryFilter.cmdline AS cmdline
	FROM nviso_events
	WHERE OsqueryFilter.cmdline IS NOT NULL
	GROUP BY OsqueryFilter.name, OsqueryFilter.cmdline, OsqueryFilter.pid
	ORDER BY OsqueryFilter.name

bucket = process_name

metrics = str, b64_encoded_len, b64_encoded

targets = b64_len

outlier_reason = A lot of B64 encoded data
outlier_summary = Process name: {process_name} - B64: {cmdline}

batch_size = 10000

trigger_method = lof
trigger_sensitivity = 50
n_neighbors = 100
